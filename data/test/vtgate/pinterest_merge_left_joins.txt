# Multi-table unique vindex constraint on left table of left join, two levels of join, simple aggregation
# Regression test for https://github.com/vitessio/vitess/issues/4772
"select user.id, count(*) from user left join user_extra ue1 on user.id = ue1.user_id left join user_extra ue2 on ue1.user_id = ue2.user_id group by user.id"
{
  "Original": "select user.id, count(*) from user left join user_extra ue1 on user.id = ue1.user_id left join user_extra ue2 on ue1.user_id = ue2.user_id group by user.id",
  "Instructions": {
    "Opcode": "SelectScatter",
    "Keyspace": {
      "Name": "user",
      "Sharded": true
    },
    "Query": "select user.id, count(*) from user left join user_extra as ue1 on user.id = ue1.user_id left join user_extra as ue2 on ue1.user_id = ue2.user_id group by user.id",
    "FieldQuery": "select user.id, count(*) from user left join user_extra as ue1 on user.id = ue1.user_id left join user_extra as ue2 on ue1.user_id = ue2.user_id where 1 != 1 group by user.id"
  }
}
